Traceback (most recent call last):
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\train.py", line 51, in <module>
    typer.run(train)
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\main.py", line 1092, in run
    app()
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\main.py", line 336, in __call__
    raise e
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\main.py", line 319, in __call__
    return get_command(self)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\click\core.py", line 1485, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\core.py", line 726, in main
    return _main(
           ^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\core.py", line 190, in _main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\click\core.py", line 1269, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\click\core.py", line 824, in invoke
    return callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\typer\main.py", line 706, in wrapper
    return callback(**use_params)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\train.py", line 27, in train
    train_set, _ = corrupt_mnist()
                   ^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\data.py", line 42, in corrupt_mnist
    root = _get_root()
           ^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\data.py", line 7, in _get_root
    return Path(get_original_cwd())
                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\hydra\utils.py", line 92, in get_original_cwd
    raise ValueError(
ValueError: get_original_cwd() must only be used after HydraConfig is initialized
[31mâ•­â”€[0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[31mâ”€â•®[0m
[31mâ”‚[0m C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\train.py:27 in train                                                                                                                                                        [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m24 [0m[2mâ”‚   â”‚   [0mnum_classes=[94m10[0m,                                                                  [34mâ•­â”€[0m[34mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[34m locals [0m[34mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m[34mâ”€â•®[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m   [2m25 [0m[2mâ”‚   [0m).to(DEVICE)                                                                         [34mâ”‚[0m [3;33mbatch_size[0m[31m =[0m [1;36m32[0m                                                            [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m   [2m26 [0m[2mâ”‚   [0m                                                                                     [34mâ”‚[0m     [3;33mepochs[0m[31m =[0m [1;36m5[0m                                                             [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m [31mâ± [0m27 [2mâ”‚   [0mtrain_set, _ = [1;4mcorrupt_mnist()[0m                                                       [34mâ”‚[0m         [3;33mlr[0m[31m =[0m [1;36m0.001[0m                                                         [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m   [2m28 [0m[2mâ”‚   [0m                                                                                     [34mâ”‚[0m      [3;33mmodel[0m[31m =[0m [1;35mMyAwesomeModel[0m[1m([0m                                               [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m   [2m29 [0m[2mâ”‚   [0mtrain_dataloader = torch.utils.data.DataLoader(train_set, batch_size=batch_size)     [34mâ”‚[0m              [2;32m  [0m[1m([0mconv1[1m)[0m: [1;35mConv2d[0m[1m([0m[1;36m1[0m, [1;36m32[0m, [33mkernel_size[0m=[1m([0m[1;36m3[0m, [1;36m3[0m[1m)[0m, [33mstride[0m=[1m([0m[1;36m1[0m, [1;36m1[0m[1m)[0m[1m)[0m   [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m   [2m30 [0m                                                                                         [34mâ”‚[0m              [2;32m  [0m[1m([0mconv2[1m)[0m: [1;35mConv2d[0m[1m([0m[1;36m32[0m, [1;36m64[0m, [33mkernel_size[0m=[1m([0m[1;36m3[0m, [1;36m3[0m[1m)[0m, [33mstride[0m=[1m([0m[1;36m1[0m, [1;36m1[0m[1m)[0m[1m)[0m  [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                               [34mâ”‚[0m              [2;32m  [0m[1m([0mconv3[1m)[0m: [1;35mConv2d[0m[1m([0m[1;36m64[0m, [1;36m128[0m, [33mkernel_size[0m=[1m([0m[1;36m3[0m, [1;36m3[0m[1m)[0m, [33mstride[0m=[1m([0m[1;36m1[0m, [1;36m1[0m[1m)[0m[1m)[0m [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                               [34mâ”‚[0m              [2;32m  [0m[1m([0mdropout[1m)[0m: [1;35mDropout[0m[1m([0m[33mp[0m=[1;36m0[0m[1;36m.5[0m, [33minplace[0m=[3;91mFalse[0m[1m)[0m                    [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                               [34mâ”‚[0m              [2;32m  [0m[1m([0mfc1[1m)[0m: [1;35mLinear[0m[1m([0m[33min_features[0m=[1;36m128[0m, [33mout_features[0m=[1;36m10[0m, [33mbias[0m=[3;92mTrue[0m[1m)[0m  [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                               [34mâ”‚[0m              [1m)[0m                                                             [34mâ”‚[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                               [34mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m                                                                  [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\data.py:42 in corrupt_mnist                                                                                                                                                 [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m39 [0m                                                                                                                                                                                                                                         [31mâ”‚[0m
[31mâ”‚[0m   [2m40 [0m[94mdef[0m[90m [0m[92mcorrupt_mnist[0m() -> [96mtuple[0m[torch.utils.data.Dataset, torch.utils.data.Dataset]:                                                                                                                                                        [31mâ”‚[0m
[31mâ”‚[0m   [2m41 [0m[2;90mâ”‚   [0m[33m"""Return train and test datasets for corrupt MNIST."""[0m                                                                                                                                                                              [31mâ”‚[0m
[31mâ”‚[0m [31mâ± [0m42 [2mâ”‚   [0mroot = [1;4m_get_root()[0m                                                                                                                                                                                                                   [31mâ”‚[0m
[31mâ”‚[0m   [2m43 [0m[2mâ”‚   [0m                                                                                                                                                                                                                                     [31mâ”‚[0m
[31mâ”‚[0m   [2m44 [0m[2mâ”‚   [0mtrain_images = torch.load(root / [33m"[0m[33mdata/processed/train_images.pt[0m[33m"[0m)                                                                                                                                                                   [31mâ”‚[0m
[31mâ”‚[0m   [2m45 [0m[2mâ”‚   [0mtrain_target = torch.load(root / [33m"[0m[33mdata/processed/train_target.pt[0m[33m"[0m)                                                                                                                                                                   [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\src_wandb\data.py:7 in _get_root                                                                                                                                                      [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m 4 [0m                                                                                                                                                                                                                                         [31mâ”‚[0m
[31mâ”‚[0m   [2m 5 [0m                                                                                                                                                                                                                                         [31mâ”‚[0m
[31mâ”‚[0m   [2m 6 [0m[94mdef[0m[90m [0m[92m_get_root[0m() -> Path:                                                                                                                                                                                                                 [31mâ”‚[0m
[31mâ”‚[0m [31mâ± [0m 7 [2mâ”‚   [0m[94mreturn[0m Path([1;4mget_original_cwd()[0m)                                                                                                                                                                                                      [31mâ”‚[0m
[31mâ”‚[0m   [2m 8 [0m                                                                                                                                                                                                                                         [31mâ”‚[0m
[31mâ”‚[0m   [2m 9 [0m[94mdef[0m[90m [0m[92mnormalize[0m(images: torch.Tensor) -> torch.Tensor:                                                                                                                                                                                     [31mâ”‚[0m
[31mâ”‚[0m   [2m10 [0m[2;90mâ”‚   [0m[33m"""Normalize images."""[0m                                                                                                                                                                                                              [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m C:\Users\asold\DTU_Local\MLOps\dtu_mlops\mnist_exercise\.venv\Lib\site-packages\hydra\utils.py:92 in get_original_cwd                                                                                                                         [31mâ”‚[0m
[31mâ”‚[0m                                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m 89 [0m[2;33mâ”‚   [0m[33m:return: the original working directory the Hydra application was launched from[0m                                                                                                                                                     [31mâ”‚[0m
[31mâ”‚[0m   [2m 90 [0m[2;33mâ”‚   [0m[33m"""[0m                                                                                                                                                                                                                                 [31mâ”‚[0m
[31mâ”‚[0m   [2m 91 [0m[2mâ”‚   [0m[94mif[0m [95mnot[0m HydraConfig.initialized():                                                                                                                                                                                                   [31mâ”‚[0m
[31mâ”‚[0m [31mâ± [0m 92 [2mâ”‚   â”‚   [0m[1;4;94mraise[0m[1;4m [0m[1;4;96mValueError[0m[1;4m([0m                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m 93 [0m[2mâ”‚   â”‚   â”‚   [0m[1;4;33m"[0m[1;4;33mget_original_cwd() must only be used after HydraConfig is initialized[0m[1;4;33m"[0m                                                                                                                                                     [31mâ”‚[0m
[31mâ”‚[0m   [2m 94 [0m[2mâ”‚   â”‚   [0m[1;4m)[0m                                                                                                                                                                                                                               [31mâ”‚[0m
[31mâ”‚[0m   [2m 95 [0m[2mâ”‚   [0mret = HydraConfig.get().runtime.cwd                                                                                                                                                                                                 [31mâ”‚[0m
[31mâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[0m
[1;91mValueError: [0m[1;35mget_original_cwd[0m[1m([0m[1m)[0m must only be used after HydraConfig is initialized
